
plugins {
    id 'java'
    id 'application'
}

group = 'pl.jblew.doing'
mainClassName = 'pl.jblew.doing.Doing'

dependencies {
    compile 'info.picocli:picocli:3.1.0'
    compile 'com.fasterxml.jackson:jackson-base:2.9.6'
    compile 'com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.9.6'
    compile 'com.fasterxml.jackson.core:jackson-databind:2.9.6'
    compile 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.9.6'

    testCompile 'junit:junit:4.12'
}

repositories {
    jcenter()
}

jar {
    manifest {
        attributes(
                'Main-Class': project.mainClassName
        )
    }
}

task fatJar(type: Jar) {
    manifest.from jar.manifest
    classifier = 'all'
    from {
        configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) }
    } {
        exclude "META-INF/*.SF"
        exclude "META-INF/*.DSA"
        exclude "META-INF/*.RSA"
    }
    with jar
}

artifacts {
    archives fatJar
}